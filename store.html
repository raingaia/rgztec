<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>RGZTEC • Store</title>

  <!-- Ortak stiller (header, arama, kategoriler, CTA vs.) -->
  <link rel="stylesheet" href="/rgztec/assets/css/base.css" />
  <!-- Ortak header + kategorileri enjekte eder ve aktif sekmeyi işaretler -->
  <script defer src="/rgztec/assets/js/layout.js"></script>

  <style>
    /* Mağaza sayfasına özel ufak stiller */
    :root{
      --line:#E5E7EB; --muted:#6B7280; --brand:#f97316; --brandDark:#ea580c;
    }
    .store-hero{max-width:1200px; margin:16px auto; padding:16px}
    .s-card{
      background:#fff; border:1px solid var(--line); border-radius:16px;
      box-shadow:0 10px 28px rgba(0,0,0,.07);
      padding:18px; display:flex; align-items:center; gap:16px;
    }
    .s-avatar{
      width:64px; height:64px; border-radius:12px; display:flex;
      align-items:center; justify-content:center; font-weight:900; color:#fff; font-size:22px;
    }
    .s-title{font-size:28px; font-weight:800; margin:0}
    .s-desc{margin:6px 0 0; color:var(--muted)}
    .inline-search{margin-top:10px; display:flex; gap:10px}
    .inline-search input{flex:1; border:1px solid var(--line); border-radius:999px; padding:10px 12px}
    .btn{background:var(--brand); color:#fff; border:0; border-radius:999px; padding:10px 16px; font-weight:700; cursor:pointer}
    .btn:hover{background:var(--brandDark)}
    .btn.ghost{background:#fff; color:var(--brand); border:2px solid var(--brand)}
    .btn.ghost:hover{color:var(--brandDark); border-color:var(--brandDark)}

    .main{max-width:1200px; margin:20px auto; padding:0 16px 32px}
    .products-grid{display:grid; gap:16px; grid-template-columns:repeat(4,1fr)}
    @media(max-width:992px){.products-grid{grid-template-columns:repeat(3,1fr)}}
    @media(max-width:768px){.products-grid{grid-template-columns:repeat(2,1fr)}}
    @media(max-width:480px){.products-grid{grid-template-columns:1fr}}
    .product{
      border:1px solid var(--line); border-radius:12px; padding:12px; background:#fff;
      transition:transform .12s, box-shadow .12s;
    }
    .product:hover{transform:translateY(-2px); box-shadow:0 12px 22px rgba(0,0,0,.08)}
    .p-title{font-weight:700; margin:6px 0 2px}
    .p-desc{color:var(--muted); font-size:14px}
  </style>
</head>
<body>

  <!-- Header + Kategori barı JS ile otomatik eklenecek -->

  <!-- ===== Mağaza Kartı (slug'a göre dolar) ===== -->
  <section class="store-hero">
    <div class="s-card">
      <div id="avatar" class="s-avatar" style="background:#111827">ST</div>
      <div style="flex:1">
        <h1 id="storeName" class="s-title">Store</h1>
        <p id="storeDesc" class="s-desc">Store description…</p>

        <div class="inline-search">
          <input id="storeSearch" placeholder="Search within this store…" />
          <button class="btn" onclick="onStoreSearch()">Search</button>
          <button class="btn ghost" onclick="location.hash='#products'">View Products</button>
        </div>
      </div>
    </div>
  </section>

  <!-- ===== Ürünler ===== -->
  <main class="main">
    <h2 id="products">Products</h2>
    <div id="productsGrid" class="products-grid"></div>
  </main>

<script>
/* Basit mağaza içi arama örneği (grid filtreler) */
function onStoreSearch(){
  const q = (document.getElementById('storeSearch').value || '').toLowerCase();
  if(!window.__PRODUCTS__){ return; }
  renderProducts(q ? window.__PRODUCTS__.filter(p => (p.name+p.desc).toLowerCase().includes(q)) : window.__PRODUCTS__);
}

function renderProducts(list){
  const grid = document.getElementById('productsGrid');
  if(!list || !list.length){
    grid.innerHTML = `<div style="grid-column:1/-1;color:#6B7280">No products yet.</div>`;
    return;
  }
  grid.innerHTML = list.map(p => `
    <div class="product">
      <div style="height:120px;border-radius:10px;background:${p.color||'#f3f4f6'};display:flex;align-items:center;justify-content:center;font-weight:800;">
        ${p.short || p.name.substring(0,2).toUpperCase()}
      </div>
      <div class="p-title">${p.name}</div>
      <div class="p-desc">${p.desc || ''}</div>
    </div>
  `).join('');
}

/* Mağaza verisini slug'a göre yükle */
(async function(){
  const params = new URLSearchParams(location.search);
  const slug   = params.get('slug') || 'dev-studio-one';

  try{
    // Mağazalar dosyası
    const data  = await fetch('/rgztec/data/stores.json', {cache:'no-store'}).then(r=>r.json());
    const store = (data.stores||[]).find(s => s.slug === slug);

    if(store){
      document.title = `RGZTEC • ${store.name}`;
      document.getElementById('storeName').textContent = store.name;
      document.getElementById('storeDesc').textContent = store.desc || '';
      document.getElementById('avatar').style.background = store.color || '#111827';
      document.getElementById('avatar').textContent = (store.short || (store.name||'').split(' ').map(w=>w[0]).slice(0,2).join('')).toUpperCase();

      // Ürünler (varsa)
      window.__PRODUCTS__ = store.products || [];
      renderProducts(window.__PRODUCTS__);
    } else {
      document.getElementById('storeName').textContent = 'Store not found';
      renderProducts([]);
    }
  }catch(e){
    console.error(e);
    renderProducts([]);
  }
})();
</script>
</body>
</html>
