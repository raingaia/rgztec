<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Store • RGZTEC</title>
<meta name="description" content="Store page on RGZTEC marketplace"/>
<style>
  :root{--brand:#FF6A00;--dark:#0F172A;--light:#F9FAFB;--white:#fff;
    --line:#E5E7EB;--muted:#6B7280;--radius:16px;--shadow:0 10px 28px rgba(0,0,0,.07)}
  *{box-sizing:border-box}
  body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial;background:var(--light);color:var(--dark)}
  header{position:sticky;top:0;background:#fff;border-bottom:1px solid var(--line);z-index:10}
  .row{max-width:1200px;margin:0 auto;padding:12px 20px;display:flex;align-items:center;gap:12px}
  .logo{font-weight:900} .spacer{flex:1}
  .wrap{max-width:1200px;margin:0 auto;padding:16px 20px}
  .hero{background:#fff;border:1px solid var(--line);border-radius:18px;box-shadow:var(--shadow);display:flex;gap:18px;align-items:center;padding:18px}
  .banner{width:110px;height:110px;border-radius:14px;display:flex;align-items:center;justify-content:center;font-weight:900;font-size:30px;color:#fff}
  .muted{color:var(--muted)}
  .chips{display:flex;gap:10px;flex-wrap:wrap;margin-top:6px}
  .chip{border:1px solid var(--line);border-radius:999px;padding:6px 10px;background:#fff;font-weight:800}
  .tools{display:flex;gap:12px;align-items:center;flex-wrap:wrap;margin-top:12px}
  .btn{display:inline-flex;align-items:center;gap:6px;padding:10px 14px;border-radius:12px;font-weight:800;cursor:pointer}
  .btn.primary{background:var(--brand);color:#fff;border:0}
  .search{flex:1;display:flex;background:#fff;border:1px solid var(--line);border-radius:999px;overflow:hidden;min-width:220px}
  .search input{flex:1;border:0;padding:10px 12px}
  .search button{background:var(--brand);border:0;color:#fff;padding:10px 14px;font-weight:900}
  h2{margin:18px 0 10px}
  .grid{display:grid;gap:18px;grid-template-columns:repeat(4,1fr)}
  .card{background:#fff;border:1px solid var(--line);border-radius:16px;overflow:hidden;box-shadow:var(--shadow);
        transition:transform .12s, box-shadow .12s;display:flex;flex-direction:column}
  .card:hover,.card:focus-within{transform:translateY(-3px);box-shadow:0 16px 30px rgba(0,0,0,.12)}
  .thumb{height:160px;display:flex;align-items:center;justify-content:center;font-size:28px;font-weight:900;color:#fff}
  .body{padding:14px}
  .title{font-weight:900}
  .desc{color:var(--muted);font-size:14px;margin-top:6px;min-height:36px}
  @media(max-width:992px){.grid{grid-template-columns:repeat(3,1fr)}}
  @media(max-width:768px){.grid{grid-template-columns:repeat(2,1fr)}}
  @media(max-width:480px){.grid{grid-template-columns:1fr}.search{width:100%}}
</style>
</head>
<body>
<header>
  <div class="row">
    <a id="homeLink" class="logo" href="#">RGZTEC</a>
    <div class="spacer"></div>
    <a id="storesLink" href="#">All Stores</a>
  </div>
</header>

<div class="wrap">
  <div id="hero" class="hero" aria-live="polite">
    <div id="banner" class="banner">RG</div>
    <div style="flex:1">
      <h1 id="name" style="margin:0 0 6px">Store</h1>
      <div id="desc" class="muted">Description</div>
      <div id="chips" class="chips"></div>
      <div class="tools">
        <form class="search" onsubmit="return false">
          <input id="q" placeholder="Search within this store…">
          <button onclick="doSearch()">Search</button>
        </form>
        <button class="btn primary" onclick="scrollToProducts()">View Products</button>
      </div>
    </div>
  </div>

  <h2>Products</h2>
  <div id="grid" class="grid"></div>
  <p id="err" class="muted" style="display:none;margin-top:12px"></p>
</div>

<script>
  // --- BASE (repo uyumlu) ---
  function getBase(){
    const parts = location.pathname.split('/').filter(Boolean);
    if (parts.length && parts[0] !== 'stores' && parts[0] !== 'data' && !parts[0].endsWith('.html')) {
      return '/' + parts[0] + '/'; // /rgztec/
    }
    return '/';
  }
  const BASE = getBase();
  document.getElementById('homeLink').href   = BASE;
  document.getElementById('storesLink').href = BASE + 'stores/';

  // --- SLUG ---
  function getSlug(){
    const url = new URL(location.href);
    if (url.searchParams.get('slug')) return url.searchParams.get('slug');
    const parts = location.pathname.split('/').filter(Boolean);
    const i = parts.indexOf('stores');
    return (i > -1 && parts[i+1]) ? parts[i+1] : null;
  }
  function initials(name){return name.split(' ').slice(0,2).map(s=>s[0]).join('').toUpperCase()}

  async function load(){
    const slug = getSlug();
    const err  = document.getElementById('err');
    if(!slug){ err.style.display='block'; err.textContent='Slug bulunamadı.'; return; }

    let data;
    try{
      const res = await fetch(BASE + 'data/stores.json', {cache:'no-store'});
      if(!res.ok) throw new Error('JSON yüklenemedi: '+res.status);
      data = await res.json();
    }catch(e){
      err.style.display='block';
      err.textContent = 'Veri yüklenemedi: ' + e.message + ' → ' + BASE + 'data/stores.json';
      return;
    }

    const store = (data.stores||[]).find(s=>s.slug===slug);
    if(!store){ err.style.display='block'; err.textContent='Mağaza bulunamadı: '+slug; return; }

    document.title = `${store.name} • RGZTEC Store`;
    document.getElementById('name').textContent = store.name;
    document.getElementById('desc').textContent = store.desc || '';
    const ban = document.getElementById('banner');
    ban.style.background = store.color || '#0F172A';
    ban.textContent = initials(store.name);

    document.getElementById('chips').innerHTML = (store.badges||[])
      .map(b=>`<span class="chip">${b}</span>`).join('');

    const grid = document.getElementById('grid');
    grid.innerHTML = (store.products||[]).map(p=>`
      <a class="card" href="${p.href || '#'}">
        <div class="thumb" style="background:${store.color || '#0F172A'}">${p.title}</div>
        <div class="body">
          <div class="title">${p.title}</div>
          <div class="desc">${p.note || ''}</div>
        </div>
      </a>
    `).join('');
  }

  function scrollToProducts(){ document.getElementById('grid').scrollIntoView({behavior:'smooth'}) }
  function doSearch(){
    const q = (document.getElementById('q').value || '').toLowerCase();
    document.querySelectorAll('#grid .card').forEach(c=>{
      c.style.display = c.textContent.toLowerCase().includes(q) ? '' : 'none';
    });
  }
  load();
</script>
</body>
</html>
