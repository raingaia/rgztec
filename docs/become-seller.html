<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>RGZTEC • Open Store</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=Plus+Jakarta+Sans:wght@600;700;800&display=swap" rel="stylesheet">

<script src="https://cdn.tailwindcss.com"></script>
<script>
    tailwind.config = {
      theme: {
        extend: {
          colors: { 
            'brand': '#f97316', 
            'ink': '#0f172a', 
            'sub': '#64748b',
            'line': '#e2e8f0', // border rengi
            'bg-body': '#f8fafc', // ana gövde rengi
          },
          boxShadow: { 'soft': '0 4px 20px rgba(0,0,0,.03), 0 10px 30px rgba(0,0,0,.08)' } // Kurumsal gölge
        }
      }
    }
</script>
<style>
/* Header ve Body ayarları için Tailwind dışı basit stiller */
body { font-family: 'Inter', sans-serif; background-color: var(--bg-body); color: var(--ink); margin: 0; }
.logo { font-family: 'Plus Jakarta Sans', sans-serif; font-weight: 800; }
.container { max-width: 1440px; margin: 0 auto; padding: 0 24px; }

/* Mega Menü Transitionları (Tailwind ile zor olan kısımlar) */
.mega-menu-overlay { transition: opacity 0.3s ease, visibility 0.3s ease; }
.mega-menu-container { transition: all 0.3s cubic-bezier(0.16, 1, 0.3, 1); }
</style>
</head>
<body class="bg-bg-body text-ink">

<header class="sticky top-0 z-50 bg-white/90 backdrop-blur border-b border-line shadow-sm h-[74px] flex items-center">
  <div class="container flex items-center justify-between w-full gap-6">
    <div class="flex items-center gap-6">
      <a href="./" class="logo text-xl text-brand tracking-tight font-extrabold" aria-label="RGZTEC Home">RGZTEC</a>
      
      <button class="flex items-center gap-2 text-sm font-semibold text-ink hover:text-brand transition" id="btnCategories">
        <svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M4 6h16M4 12h16M4 18h16"></path></svg>
        Categories
      </button>
    </div>
    
    <div class="relative flex-1 max-w-lg hidden md:block">
      <input type="text" class="w-full h-10 bg-gray-100 border border-transparent rounded-full px-4 pr-12 text-sm text-ink focus:ring-2 focus:ring-brand focus:border-brand transition outline-none" placeholder="Search marketplace...">
      <button class="absolute right-2 top-1/2 -translate-y-1/2 w-8 h-8 rounded-full bg-brand text-white flex items-center justify-center">
        <svg width="18" height="18" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z" /></svg>
      </button>
    </div>

    <div class="flex items-center gap-5">
      <a href="editor/" class="text-sm font-semibold text-sub hover:text-brand transition hidden lg:block">Dashboard</a>
      <a href="login.html" class="text-sm font-semibold text-sub hover:text-brand transition hidden sm:block">Sign In</a>
      <a href="open-store.html" class="inline-flex items-center justify-center h-10 px-5 rounded-full bg-ink text-white text-sm font-bold hover:bg-brand transition">Open Store</a>
    </div>
  </div>
</header>

<div class="mega-menu-overlay fixed top-[74px] left-0 w-full h-[calc(100vh-74px)] bg-ink/30 z-40 opacity-0 invisible" id="megaMenu">
  <div class="mega-menu-container absolute top-3 left-6 w-[900px] h-[500px] bg-white flex rounded-2xl shadow-soft border border-line opacity-0 scale-[0.98]">
    <div class="menu-sidebar w-72 bg-gray-50 border-r border-line p-4 overflow-y-auto" id="menuSidebar">
        <p class="text-sub text-sm p-4">Loading...</p>
    </div>
    <div class="menu-content flex-1 p-8 overflow-y-auto" id="menuContent">
      <div class="menu-header">
          <h3 id="menuTitle" class="text-2xl font-extrabold tracking-tight mb-2">Select a Category</h3>
          <p id="menuDesc" class="text-sub text-sm mb-6">Browse items</p>
      </div>
      <div id="menuGrid" class="grid grid-cols-2 gap-4"></div>
    </div>
  </div>
</div>

<div class="container pt-10 pb-16">
  <h1 class="text-3xl md:text-4xl font-extrabold tracking-tight mb-2">Open your store</h1>
  <p class="text-lg text-sub mb-8">Create your first product and upload images. (Demo Mode)</p>

  <div class="grid lg:grid-cols-2 gap-8">
    <div class="bg-white border border-line rounded-2xl shadow-soft p-6 md:p-8">
      <form id="f" class="space-y-4">
        
        <div>
          <label class="block text-sm font-bold mb-2 text-ink">Product title</label>
          <input name="title" placeholder="e.g., Sticky Header UI Kit" required class="w-full p-3 border border-line rounded-xl text-sm focus:ring-brand focus:border-brand transition outline-none">
        </div>

        <div>
          <label class="block text-sm font-bold mb-2 text-ink">Description</label>
          <textarea name="desc" placeholder="Tell buyers what they get…" required class="w-full p-3 border border-line rounded-xl text-sm min-h-[120px] resize-y focus:ring-brand focus:border-brand transition outline-none"></textarea>
        </div>

        <div class="grid grid-cols-2 gap-4">
          <div>
            <label class="block text-sm font-bold mb-2 text-ink">Price (USD)</label>
            <input name="price" type="number" min="0" step="1" placeholder="29" required class="w-full p-3 border border-line rounded-xl text-sm focus:ring-brand focus:border-brand transition outline-none">
          </div>
          <div>
            <label class="block text-sm font-bold mb-2 text-ink">Category</label>
            <select id="cat" name="cat" required class="w-full p-3 border border-line rounded-xl text-sm focus:ring-brand focus:border-brand transition outline-none bg-white">
              <option value="" disabled selected>Loading categories...</option>
              </select>
          </div>
        </div>

        <div>
          <label class="block text-sm font-bold mb-2 text-ink">Images</label>
          <div id="drop" class="drop border-2 border-dashed border-line rounded-xl p-6 text-center bg-gray-50 cursor-pointer hover:border-brand hover:bg-orange-50 transition">
            <strong class="text-ink">Drag & drop images</strong>
            <p class="text-xs text-sub mt-1">PNG, JPG, WEBP (max ~5MB each)</p>
            <input type="file" id="file" hidden multiple accept="image/*">
          </div>
          <div id="gallery" class="flex gap-3 flex-wrap mt-4" aria-live="polite"></div>
        </div>

        <div id="statusMsg" class="p-3 mt-4 rounded-lg text-sm hidden" role="alert"></div>
        
        <div class="pt-4 flex gap-3 flex-wrap">
          <button type="submit" class="inline-flex items-center justify-center h-11 px-6 rounded-xl bg-brand text-white font-bold hover:bg-orange-700 shadow-lg transition">
            Save Draft
          </button>
          <a href="editor/" class="inline-flex items-center justify-center h-11 px-6 rounded-xl border border-line bg-white text-ink font-semibold hover:bg-gray-50 transition">
            Go to Dashboard
          </a>
        </div>
      </form>
    </div>

    <div class="bg-white border border-line rounded-2xl shadow-soft p-6 md:p-8 self-start">
      <h3 class="text-xl font-bold tracking-tight mb-4">How uploads work here?</h3>
      <p class="text-sm text-sub leading-relaxed mb-4">
        Because this is static hosting, files aren’t sent to a server. We keep a **demo draft** in your browser (localStorage) and show image previews. For production, point to your API/S3.
      </p>
      <ul class="list-disc list-inside text-sm text-sub space-y-2">
        <li>Drag images into the box or click it</li>
        <li>Fill the product form</li>
        <li>“Save draft” stores locally under `rgztec_drafts`</li>
        <li>Hook `ENDPOINT` to upload for real</li>
      </ul>
    </div>
  </div>
</div>

<footer class="border-t border-line bg-ink text-sub mt-16 py-10">
    <div class="container">
        <div class="grid md:grid-cols-4 gap-8 mb-8">
            <div>
                <h4 class="text-white font-semibold mb-3">Shop</h4>
                <a href="gift-card.html" class="block text-sm hover:text-white">Gift Cards</a>
                <a href="#" class="block text-sm hover:text-white">Sitemap</a>
            </div>
            <div>
                <h4 class="text-white font-semibold mb-3">Sell</h4>
                <a href="become-seller.html" class="block text-sm hover:text-white">Start Selling</a>
                <a href="#" class="block text-sm hover:text-white">Teams</a>
            </div>
            <div>
                <h4 class="text-white font-semibold mb-3">Company</h4>
                <a href="#" class="block text-sm hover:text-white">About</a>
                <a href="#" class="block text-sm hover:text-white">Careers</a>
            </div>
            <div>
                <h4 class="text-white font-semibold mb-3">Support</h4>
                <a href="mailto:support@rgztec.com" class="block text-sm hover:text-white">Help Center</a>
            </div>
        </div>
        <div class="border-t border-gray-700 pt-6 flex justify-between text-xs">
            <span>© 2025 RGZTEC, Inc.</span>
            <div>
                <a href="#" class="hover:text-white ml-4">Privacy</a>
                <a href="#" class="hover:text-white ml-4">Terms</a>
            </div>
        </div>
    </div>
</footer>

<script>
/* --- 1. GLOBAL VERİ YÖNETİMİ (JSON PARSE) --- */
let RAW_DATA = {}; 

document.addEventListener('DOMContentLoaded', async () => {
    const catSelect = document.getElementById('cat');
    const menuSidebar = document.getElementById('menuSidebar');

    try {
        // JSON Verisini Çek
        const response = await fetch('store.data.json'); 
        
        if (!response.ok) throw new Error("JSON dosyası bulunamadı.");
        
        RAW_DATA = await response.json();
        
        // 2. Form Dropdown'ı Temizle
        catSelect.innerHTML = '<option value="" disabled selected>Select a category...</option>';
        
        // 3. PARSING MANTIĞI: Nesne anahtarları üzerinde dönülüyor
        Object.keys(RAW_DATA).forEach(storeKey => {
            const store = RAW_DATA[storeKey];
            
            // Ana başlık grubu oluştur (Örn: GAME MAKERS)
            const group = document.createElement('optgroup');
            group.label = store.title;
            
            // Alt bölümleri (sections) seçenek olarak ekle
            if (store.sections && Array.isArray(store.sections)) {
                store.sections.forEach(sec => {
                    const opt = document.createElement('option');
                    // Value'ya hem ana key'i hem slug'ı koyuyoruz (örn: game-makers|prototypes)
                    opt.value = `${storeKey}|${sec.slug}`; 
                    opt.textContent = sec.name; // Örn: Prototypes, UI & HUD
                    group.appendChild(opt);
                });
            }
            catSelect.appendChild(group);
        });

        // 4. Mega Menü Sidebar'ını Doldur
        let sidebarHTML = '';
        Object.keys(RAW_DATA).forEach(storeKey => {
            const store = RAW_DATA[storeKey];
            sidebarHTML += `
            <div class="menu-store-item flex justify-between items-center px-4 py-3 text-sm font-semibold rounded-lg cursor-pointer hover:bg-white hover:text-brand transition" onclick="selectMenuCategory('${storeKey}')" data-key="${storeKey}">
                <span>${store.title}</span>
                <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/></svg>
            </div>`;
        });
        menuSidebar.innerHTML = sidebarHTML;

        // İlk menüyü seçili yap
        const firstKey = Object.keys(RAW_DATA)[0];
        if(firstKey) selectMenuCategory(firstKey);

    } catch (err) {
        console.error("Hata Detayı:", err);
        catSelect.innerHTML = '<option disabled>Error loading data</option>';
        menuSidebar.innerHTML = '<p class="text-red-500 p-4">Data could not be loaded. Check console for details.</p>';
    }
});

/* --- MEGA MENÜ MANTIĞI --- */
const megaMenu = document.getElementById('megaMenu');
const btnCategories = document.getElementById('btnCategories');
const menuTitle = document.getElementById('menuTitle');
const menuDesc = document.getElementById('menuDesc');
const menuGrid = document.getElementById('menuGrid');

window.selectMenuCategory = function(key) {
    document.querySelectorAll('.menu-store-item').forEach(el => el.classList.remove('bg-white', 'text-brand'));
    const activeItem = document.querySelector(`.menu-store-item[data-key="${key}"]`);
    if(activeItem) activeItem.classList.add('bg-white', 'text-brand');

    const store = RAW_DATA[key];
    if(store) {
        menuTitle.textContent = store.title;
        menuDesc.textContent = store.tagline || "";
        
        let gridHTML = '';
        if (store.sections) {
            store.sections.forEach(sec => {
                gridHTML += `
                <a href="#" class="block p-3 border border-line rounded-lg text-sm text-ink hover:border-brand hover:bg-orange-50 transition">
                    <div class="font-bold">${sec.name}</div>
                    <div class="text-xs text-sub mt-1">${sec.tagline || "Browse"}</div>
                </a>`;
            });
        }
        menuGrid.innerHTML = gridHTML;
    }
}

// Menüyü Aç/Kapa
btnCategories.addEventListener('click', (e) => {
    e.stopPropagation();
    megaMenu.classList.toggle('open');
    if(megaMenu.classList.contains('open')) {
        megaMenu.classList.remove('opacity-0', 'invisible');
        megaMenu.querySelector('.mega-menu-container').classList.remove('opacity-0', 'scale-[0.98]');
    } else {
        megaMenu.classList.add('opacity-0', 'invisible');
        megaMenu.querySelector('.mega-menu-container').classList.add('opacity-0', 'scale-[0.98]');
    }
});
document.addEventListener('click', (e) => {
    if(!megaMenu.contains(e.target) && !btnCategories.contains(e.target)) {
        megaMenu.classList.remove('open', 'opacity-0', 'invisible');
        megaMenu.querySelector('.mega-menu-container').classList.add('opacity-0', 'scale-[0.98]');
    }
});

/* --- 3. FORM GÖNDERME & RESİM YÜKLEME --- */
// (Bu kısım önceki kodundan alınmıştır ve Premiumlaştırmaya uygundur)
const f = document.getElementById('f');
const drop = document.getElementById('drop');
const fileInp = document.getElementById('file');
const gallery = document.getElementById('gallery');
const statusMsg = document.getElementById('statusMsg');

// Sürükle Bırak Olayları
drop.addEventListener('click', () => fileInp.click());
drop.addEventListener('dragover', (e) => { e.preventDefault(); drop.classList.add('border-brand', 'bg-orange-50'); });
drop.addEventListener('dragleave', () => { drop.classList.remove('border-brand', 'bg-orange-50'); });
drop.addEventListener('drop', (e) => {
    e.preventDefault();
    drop.classList.remove('border-brand', 'bg-orange-50');
    handleFiles(e.dataTransfer.files);
});
fileInp.addEventListener('change', (e) => handleFiles(e.target.files));

function handleFiles(files) {
    Array.from(files).forEach(file => {
        if(file.type.startsWith('image/')) {
            const reader = new FileReader();
            reader.onload = (e) => {
                const img = document.createElement('img');
                img.src = e.target.result;
                img.className = 'w-20 h-20 object-cover rounded-lg border border-line shadow-sm';
                gallery.appendChild(img);
            };
            reader.readAsDataURL(file);
        }
    });
}

f.addEventListener('submit', (e) => {
    e.preventDefault();
    
    // Basit doğrulama
    const cat = f.cat.value;
    if (!cat) {
        statusMsg.style.display = 'block';
        statusMsg.className = 'p-3 mt-4 rounded-lg text-sm bg-red-100 text-red-700';
        statusMsg.textContent = '❌ Lütfen bir kategori seçin.';
        return;
    }

    // Başarılı demo kayıt işlemi
    statusMsg.style.display = 'block';
    statusMsg.className = 'p-3 mt-4 rounded-lg text-sm bg-green-100 text-green-700';
    statusMsg.textContent = '✅ Ürün yerel taslak olarak kaydedildi. Kontrol paneline yönlendiriliyor...';
    
    // Gerçek bir senaryoda burada fetch(POST) yapılır.
    setTimeout(() => {
        window.location.href = 'editor/';
    }, 1500);
});
</script>
</body>
</html>
