<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>RGZTEC • AI Tools Hub</title>

  <meta name="rgz-base" content="" />

  <!-- ✅ AWS app origin -->
  <meta name="rgztec-app-origin" content="https://YOUR-AWS-APP-DOMAIN" />

  <script>
    (function () {
      // ---- BASE ----
      function resolveBase() {
        const meta = document.querySelector('meta[name="rgz-base"]');
        if (meta && meta.content != null) return String(meta.content).trim().replace(/\/+$/, "");
        const p = location.pathname || "/";
        return p.includes("/rgztec/") ? "/rgztec" : "";
      }
      const BASE = resolveBase();
      const withBase = (p) => (BASE ? `${BASE}${p}` : p);

      // expose
      window.RGZ_BASE = BASE;
      window.RGZ_WITH_BASE = withBase;

      // ---- DATA + ASSETS ----
      window.RGZ_DATA_URL = withBase("/data/store.data.json?v=" + Date.now());
      window.RGZ_IMAGE_BASE = withBase("/assets/images/store/");

      // core css (store style)
      const css = document.createElement("link");
      css.rel = "stylesheet";
      css.href = withBase("/assets/css/store-core.css?v=1");
      css.onerror = () => console.error("CSS 404:", css.href);
      document.head.appendChild(css);
    })();
  </script>
</head>

<body class="store-body">
  <div id="store-root"></div>

  <script>
    (function () {
      const withBase = window.RGZ_WITH_BASE || ((p) => p);

      // ✅ data-path MUST exist before shell runs
      const path = (location.pathname || "/").replace(/\/+$/, "");
      const parts = path.split("/").filter(Boolean);

      // /store/<root>/<section?>/... → data-path="<root>/<section?>"
      let dataPath = "home";
      const storeIdx = parts.indexOf("store");

      if (storeIdx >= 0) {
        const root = parts[storeIdx + 1] || "";
        const section = parts[storeIdx + 2] || "";
        dataPath = section ? `${root}/${section}` : (root || "home");
      } else {
        dataPath = parts[parts.length - 1] || "home";
      }

      document.body.setAttribute("data-path", dataPath);

      // ✅ load shell
      const s = document.createElement("script");
      s.src = withBase("/assets/js/store-shell.js?v=1");
      s.async = false;

      s.onerror = () => {
        document.getElementById("store-root").innerHTML =
          "<div style='max-width:1440px;margin:24px auto;padding:16px 24px;border:1px solid #eee;border-radius:12px;background:#fff'>" +
          "<b>Shell JS not found</b><br/>" +
          "Tried: <code>" + s.src + "</code>" +
          "</div>";
      };

      document.body.appendChild(s);
    })();
  </script>
</body>
</html>

