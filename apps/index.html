<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title id="dynamic-title">RGZTEC • Engine</title>
  
  <script>
    (function () {
      // 1. URL Analizi (Örn: /apps/admin/settings -> module: admin, params: ['settings'])
      const fullPath = window.location.pathname;
      const pathSegments = fullPath.replace("/apps/", "").replace(/\/$/, "").split('/');
      
      const module = pathSegments[0] || 'dashboard'; 
      const params = pathSegments.slice(1);

      // 2. Dinamik Başlık Yönetimi
      const formatTitle = (str) => str.replace(/-/g, ' ').toUpperCase();
      document.title = `RGZTEC • ${formatTitle(module)}`;

      // 3. Global RGZ Base Ayarları
      function resolveBase() {
        const meta = document.querySelector('meta[name="rgz-base"]');
        if (meta && meta.content != null) return String(meta.content).trim().replace(/\/+$/, "");
        return fullPath.includes("/rgztec/") ? "/rgztec" : "";
      }
      
      const BASE = resolveBase();
      window.RGZ_BASE = BASE;
      window.RGZ_WITH_BASE = (p) => (BASE ? `${BASE}${p}` : p);

      // 4. Premium CSS Enjeksiyonu
      const css = document.createElement("link");
      css.rel = "stylesheet";
      css.href = window.RGZ_WITH_BASE("/assets/css/store-core.css");
      document.head.appendChild(css);

      // 5. Dinamik Kontrol Değişkenleri (Shell.js bu verileri kullanacak)
      window.APPS_MODE = module; 
      window.APPS_PARAMS = params;
      console.log(`[RGZ-ENGINE] Module: ${module} initialized with params:`, params);
    })();
  </script>
</head>
<body class="store-body" data-engine="dynamic">
  
  <div id="store-root">
    </div>

  <script>
    (function () {
      // Body'ye aktif modülü etiketle (CSS seçicileri için)
      document.body.setAttribute("data-active-module", window.APPS_MODE);
      
      const withBase = window.RGZ_WITH_BASE || ((p) => p);
      const s = document.createElement("script");
      s.defer = true;
      s.src = withBase("/assets/js/store-shell.js");
      document.body.appendChild(s);
    })();
  </script>
</body>
</html>
