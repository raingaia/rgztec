<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>RGZTEC • Engine</title>
  <script>
    (function () {
      "use strict";
      function resolveBase() {
        const meta = document.querySelector('meta[name="rgz-base"]');
        if (meta && meta.content != null) return String(meta.content).trim().replace(/\/+$/, "");
        const p = location.pathname || "/";
        return p.includes("/rgztec/") ? "/rgztec" : "";
      }
      const BASE = resolveBase();
      const withBase = (p) => (BASE ? `${BASE}${p}` : p);
      window.RGZ_BASE = BASE;
      window.RGZ_WITH_BASE = withBase;

      function parseAppsRoute() {
        let path = location.pathname || "/";
        if (BASE && path.startsWith(BASE)) path = path.slice(BASE.length);
        
        // Hem /apps/ hem de /store/ kısmını temizle
        let rest = path.replace(/^\/(apps|store)/, "").replace(/^\/+/, "").replace(/\/+$/, "");
        const parts = rest.split("/").filter(Boolean);
        
        // Eğer yol /store/hardware ise modül 'hardware' olur. Eğer /apps/admin ise modül 'admin' olur.
        return { module: parts[0] || "dashboard", params: parts.slice(1) };
      }

      const { module, params } = parseAppsRoute();
      window.APPS_MODE = module;
      window.APPS_PARAMS = params;

      const formatTitle = (s) => String(s).replace(/-/g, " ").replace(/\b\w/g, c => c.toUpperCase());
      document.title = `RGZTEC • ${formatTitle(module)}`;

      const css = document.createElement("link");
      css.rel = "stylesheet";
      css.href = withBase("/assets/css/store-core.css");
      document.head.appendChild(css);
    })();
  </script>
</head>
<body class="store-body" data-engine="dynamic">
  <div id="store-root"></div>
  <script>
    (function () {
      document.body.setAttribute("data-active-module", window.APPS_MODE);
      const s = document.createElement("script");
      s.defer = true;
      s.src = window.RGZ_WITH_BASE("/assets/js/store-shell.js");
      document.body.appendChild(s);
    })();
  </script>
</body>
</html>

