<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>RGZTEC ‚Ä¢ Store</title>
<meta name="description" content="Browse a dedicated RGZTEC store."/>

<!-- ALT KLAS√ñR ƒ∞√áƒ∞N ZORUNLU -->
<base href="/rgztec/apps/web/public/">
<!-- Mevcut stillerin -->
<link rel="stylesheet" href="assets/css/base.css">
<link rel="stylesheet" href="assets/css/styles.css">
<link rel="stylesheet" href="assets/css/card.css">

<style>
  :root{
    --wrap:1280px; --rail-w:980px; --search-h:44px;
    --text:#111827; --muted:#64748b; --icon:#6b7280; --hover:#0b0b0b;
    --line:#e5e7eb; --line-strong:#cbd5e1;
    --rgztec:#f97316; --rgztec-dark:#ea580c;
    --studio-bg:#22c3dc; --tile: clamp(72px, 7vw, 92px);
  }
  *{box-sizing:border-box}
  body{margin:0;font-family:Inter,system-ui,Segoe UI,Roboto,Arial,sans-serif;color:var(--text);background:#fff}

  /* HEADER ‚Äì dokunulmadƒ± */
  .topbar{background:#fff}
  .wrap{max-width:var(--wrap); margin:0 auto; padding:12px 18px 0}
  .hdr{display:grid; grid-template-columns:1fr minmax(0,var(--rail-w)) 1fr; align-items:center; column-gap:16px}
  .left{ display:flex; align-items:center; gap:10px; justify-self:start }
  .brand{ font-weight:900; font-size:24px; color:var(--rgztec); text-decoration:none }
  .studio{white-space:nowrap; line-height:1; font-weight:800; font-size:15px; color:#fff; background:var(--studio-bg); padding:6px 12px; border-radius:999px; display:inline-flex; align-items:center; box-shadow:0 2px 0 rgba(0,0,0,.06), inset 0 -2px 0 rgba(0,0,0,.12); transform:translateY(2px)}
  .rail{display:flex; align-items:center; justify-content:center}
  .search{width:var(--rail-w); max-width:100%; display:flex; align-items:center; gap:10px; height:var(--search-h); padding:6px 8px 6px 16px; border:2px solid #111827; border-radius:999px; background:#fff}
  .search input{ flex:1; border:0; outline:0; font-size:15px; padding:8px 6px }
  .search button{ display:grid; place-items:center; width:34px; height:34px; border-radius:999px; border:0; background:var(--rgztec); cursor:pointer; transition:transform .12s, filter .12s }
  .search button:hover{ transform:translateY(-1px); filter:brightness(.95) }
  .search svg{ width:18px; height:18px; stroke:#fff; stroke-width:2; fill:none }
  .icons{ display:flex; gap:14px; align-items:center; justify-self:end }
  .icons a{ text-decoration:none; color:var(--icon); font-size:16px }
  .open-store{ background:var(--rgztec); color:#fff !important; font-weight:700; padding:8px 18px; border-radius:999px; height:40px; display:inline-flex; align-items:center; white-space:nowrap; box-shadow:0 2px 4px rgba(0,0,0,.08); transition:all .2s }
  .open-store:hover{ background:var(--rgztec-dark); transform:translateY(-1px) }

  /* Kategori barƒ± */
  .cats-wrap{ max-width:var(--wrap); margin:0 auto; position:relative }
  .cats-wrap::after{ content:""; position:absolute; left:50%; right:50%; margin-left:-50vw; margin-right:-50vw; bottom:0; border-bottom:2px solid var(--line-strong); height:0; pointer-events:none }
  .store-bar{ --cols:5; width:var(--rail-w); max-width:100%; margin:2px auto 0; height:44px; padding:0; border-bottom:none; display:grid; grid-template-columns:repeat(var(--cols),1fr); align-items:center; justify-items:center; background:transparent }
  .store-bar a{ width:100%; text-align:center; font-size:15px; font-weight:600; letter-spacing:.1px; line-height:44px; color:var(--text); text-decoration:none; transition:color .15s }
  .store-bar a:hover{ color:var(--hover) }

  /* Hero */
  .hero{border-bottom:1px solid var(--line); background:linear-gradient(180deg,#fff,#fafbff)}
  .hero-inner{max-width:var(--wrap); margin:0 auto; padding:16px 18px}
  .h1{font-weight:900; font-size:22px; margin:0 0 4px}
  .tag{margin:0; color:var(--muted)}

  /* Featured stores */
  .stores{max-width:var(--wrap); margin:18px auto 0; padding:0 18px}
  .stores h2{font-weight:800; font-size:20px; margin:0 0 12px}
  .tiles{display:grid; grid-template-columns:repeat(auto-fit, minmax(var(--tile), 1fr)); gap:clamp(14px,2.2vw,20px); list-style:none; padding:0; margin:0}
  .tile{display:flex; flex-direction:column; align-items:center; gap:10px; text-decoration:none; color:inherit; transition:transform .18s ease}
  .tile:hover{transform:translateY(-6px)}
  .badge{width:var(--tile); height:var(--tile); border-radius:28px; display:grid; place-items:center; box-shadow:0 10px 20px -6px rgba(0,0,0,.12), inset 0 1px 0 rgba(255,255,255,.5), 0 0 0 1px rgba(0,0,0,.05)}
  .letter{font-weight:900; font-size:28px; color:#fff; text-shadow:0 2px 3px rgba(0,0,0,.2)}
  .sname{font-size:12.5px; color:var(--muted); max-width:calc(var(--tile) + 8px); text-align:center; overflow:hidden; text-overflow:ellipsis; white-space:nowrap; font-weight:500}

  /* Products grid */
  .section{max-width:var(--wrap); margin:24px auto 0; padding:0 18px}
  .section h2{font-weight:800; font-size:20px; margin:0 0 12px}
  .grid{display:grid; grid-template-columns:repeat(auto-fill,minmax(260px,1fr)); gap:18px}
  .card{border:1px solid var(--line); background:#fff; border-radius:16px; overflow:hidden; display:flex; flex-direction:column}
  .card img{width:100%; height:160px; object-fit:cover; background:#eef2f7}
  .pad{padding:12px}
  .title{font-weight:700; margin:4px 0 6px}
  .sub{color:var(--muted); font-size:14px; margin:0}
  .row{display:flex; flex-direction:column; gap:8px; justify-content:center; align-items:center; margin-top:10px}
  .price{font-weight:800; text-align:center}
  .btn{display:inline-block; width:100%; text-align:center; padding:8px 12px; border-radius:10px; border:1px solid var(--line-strong); text-decoration:none}
  .btn:hover{background:#f8fafc}

  /* SADECE hardware vitrini i√ßin k√º√ß√ºk denge ‚Äì diƒüer store‚Äôlar etkilenmez */
  body[data-store="hardware"] .tiles{ grid-template-columns:repeat(auto-fit, minmax(100px,1fr)); }
  body[data-store="hardware"] .badge{ width:96px; height:96px; border-radius:22px }

  /* Responsive */
  @media (max-width:1180px){ :root{ --rail-w: 900px } }
  @media (max-width:1040px){ :root{ --rail-w: 780px } }
  @media (max-width:900px){
    :root{ --rail-w: 100% }
    .hdr{ grid-template-columns:1fr }
    .icons a:not(.open-store){ display:none }
    .rail{ order:2 } .left{ order:1 } .icons{ order:3 }
    .store-bar{ grid-template-columns:repeat(auto-fit, minmax(120px,1fr)); height:auto }
    .store-bar a{ line-height:38px }
  }
</style>
</head>
<body>

<header class="topbar">
  <div class="wrap">
    <div class="hdr">
      <div class="left">
        <a class="brand" href="./">RGZTEC</a>
        <span id="studioName" class="studio">Store</span>
      </div>

      <div class="rail">
        <form class="search" id="searchForm">
          <input id="q" type="search" placeholder="Search for anything" aria-label="Search"/>
          <button type="submit" aria-label="Search" id="qBtn">
            <svg viewBox="0 0 24 24" aria-hidden="true">
              <circle cx="11" cy="11" r="6"></circle>
              <line x1="16.5" y1="16.5" x2="21" y2="21"></line>
            </svg>
          </button>
        </form>
      </div>

      <nav class="icons" aria-label="Quick actions">
        <a href="login" aria-label="Sign in">Sign in</a>
        <a class="icon-btn" href="gift-card.html" title="Gift cards" aria-label="Gift cards">üéÅ</a>
        <a href="cart" title="Cart" aria-label="Cart">üõí</a>
        <a href="become-seller" class="open-store" aria-label="Open your store">Open Store</a>
      </nav>
    </div>
  </div>
</header>

<div class="cats-wrap">
  <nav id="storeBar" class="store-bar" aria-label="Store Categories"></nav>
</div>

<section class="hero">
  <div class="hero-inner">
    <h1 id="heroTitle" class="h1">Store</h1>
    <p id="heroTag" class="tag"></p>
  </div>
</section>

<section class="stores">
  <h2>Featured stores</h2>
  <ul id="storeRow" class="tiles" aria-label="Featured stores"></ul>
</section>

<main class="section">
  <h2>Products</h2>
  <div id="grid" class="grid"></div>
</main>

<script>
  /* Helpers */
  const ABS_BASE = '/rgztec/apps/web/public/';
  const abs = (p='') => /^https?:|^\/rgztec\//.test(p) ? p : (ABS_BASE + p.replace(/^\.?\//,''));
  const usd = new Intl.NumberFormat('en-US',{style:'currency',currency:'USD'});
  const esc = (s='') => s.replace(/[&<>"']/g, m => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m]));

  const params = new URLSearchParams(location.search);
  const slug = (params.get('slug') || '').trim().toLowerCase();
  document.body.dataset.store = slug || ''; // hardware √∂zel stil i√ßin

  /* Header search -> listings */
  document.getElementById('searchForm')?.addEventListener('submit', (e)=>{
    e.preventDefault();
    const q = (document.getElementById('q')?.value || '').trim();
    location.href = `listings.html?store=${encodeURIComponent(slug)}${q ? `&q=${encodeURIComponent(q)}`:''}`;
  });

  /* Featured store tile */
  function tile(s){
    const name = s.name || s.slug;
    const letter = (name||'?')[0].toUpperCase();
    const [light,dark] = (s.colors || s.colorPalette || ['#a5d6ff','#3b82f6']);
    return `<li>
      <a class="tile" href="store.html?slug=${encodeURIComponent(s.slug)}" title="${esc(name)}">
        <div class="badge" style="background:radial-gradient(circle at 70% 30%, ${light}, ${dark})">
          <div class="letter">${letter}</div>
        </div>
        <div class="sname">${esc(name)}</div>
      </a>
    </li>`;
  }

  /* Product card */
  function card(p){
    const img = abs(p.thumb || 'assets/thumbs/placeholder.png');
    return `
    <div class="card">
      <img loading="lazy" src="${img}" alt="${esc(p.title)}"
           onerror="this.onerror=null;this.src='${abs('assets/thumbs/placeholder.png')}'">
      <div class="pad">
        <div class="title">${esc(p.title)}</div>
        <p class="sub">${esc(p.desc||'')}</p>
        <div class="row">
          <span class="price">${usd.format(Number(p.price||0))}</span>
          <a class="btn" href="product.html?id=${encodeURIComponent(p.id)}">Details</a>
        </div>
      </div>
    </div>`;
  }

  function renderProducts(list){
    const g = document.getElementById('grid');
    if(!list?.length){ g.innerHTML = `<div class="sub">No products found in this store.</div>`; return; }
    g.innerHTML = list.map(card).join('');
  }

  /* Normalizers */
  function normalizeProducts(raw){
    if (Array.isArray(raw)){
      return raw.map(x=>({
        id:x.id, cat:'', title:x.title,
        desc:x.description||'', price:x.price,
        thumb:abs(`assets/thumbs/${(x.image||'').replace(/\.(png|jpe?g|webp)$/i,'')||'placeholder'}.png`),
        tags:Array.isArray(x.tags)?x.tags:[]
      }));
    }
    const prods = Array.isArray(raw?.products)? raw.products.map(p=>({
      id:p.id, cat:(p.cat||'').toLowerCase(), title:p.title, desc:p.desc||'',
      price:p.price, thumb:abs(p.thumb||'assets/thumbs/placeholder.png'),
      tags:Array.isArray(p.tags)?p.tags:[]
    })) : [];
    const gallery = Array.isArray(raw?.gallery)? raw.gallery.map(x=>({
      id:`g-${x.id}`, cat:'', title:x.title, desc:x.description||'',
      price:x.price, thumb:abs(`assets/thumbs/${(x.image||'').replace(/\.(png|jpe?g|webp)$/i,'')||'placeholder'}.png`),
      tags:Array.isArray(x.tags)?x.tags:[]
    })) : [];
    return prods.length ? prods : gallery;
  }

  async function getJSON(url){
    const r = await fetch(url,{cache:'no-store'});
    if(!r.ok) throw new Error(`${url}: ${r.status}`);
    return r.json();
  }

  (async function main(){
    try{
      /* stores.json -> header + vitrin */
      const storesDoc = await getJSON('data/stores.json');
      const stores = Array.isArray(storesDoc?.stores) ? storesDoc.stores : [];
      const meta = stores.find(s => (s.slug||'').toLowerCase() === slug);

      const pill = document.getElementById('studioName');
      if (meta){
        pill.textContent = meta.name || meta.slug;
        if (meta.color) pill.style.background = meta.color;
        document.getElementById('heroTitle').textContent = meta.name || meta.slug;
        document.getElementById('heroTag').textContent = meta.tagline || '';
        document.title = `RGZTEC ‚Ä¢ ${meta.name || meta.slug}`;
      } else {
        document.getElementById('heroTitle').textContent = slug || 'Store';
        document.getElementById('heroTag').textContent = '';
      }

      // >>> hardware‚Äôda vitrin sayƒ±sƒ±nƒ± kƒ±sƒ±tla (12), diƒüerlerinde hepsi
      const featured = (slug === 'hardware') ? stores.slice(0, 12) : stores;
      document.getElementById('storeRow').innerHTML = featured.map(tile).join('');

      /* store-content.json -> √ºst kategori barƒ± */
      try{
        const content = await getJSON('data/store-content.json');
        const cats = Array.isArray(content?.[slug]?.categories) ? content[slug].categories : [];
        const bar = document.getElementById('storeBar');
        bar.innerHTML = cats.map(c => `<a href="listings.html?store=${encodeURIComponent(slug)}&tag=${encodeURIComponent(c)}">${esc(c)}</a>`).join('');
        bar.style.setProperty('--cols', String(Math.max(1, cats.length || 1)));
      }catch(e){ console.warn('store-content.json yok/bo≈ü:', e); }

      /* products.json -> √ºr√ºn grid (cat === slug) */
      const raw = await getJSON('data/products.json'); // doƒüru yol
      const all = normalizeProducts(raw);
      const list = all.filter(p => (p.cat||'').toLowerCase() === slug);
      renderProducts(list);
    }catch(e){
      console.error(e);
      document.getElementById('grid').innerHTML = `<div class="sub">${esc(String(e.message||e))}</div>`;
    }
  })();
</script>
</body>
</html>



